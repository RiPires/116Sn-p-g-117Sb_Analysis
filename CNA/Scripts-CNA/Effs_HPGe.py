##################################################################
## Script to determine HPGe mean efficiencies and uncertainties ##
#################################################################

## ---------------- ##
import numpy as np
## ---------------- ##
          #  [158 kev, Ka   , Kb    , 511 keV , 861 keV, 1004 keV]
effs_12mm = [[0.1498, 0.1457, 0.0317, 9.521e-4, 9.20e-5, 7.44e-5],
             [0.1498, 0.1458, 0.0317, 9.431e-4, 9.51e-5, 6.89e-5],
             [0.1498, 0.1457, 0.0317, 9.624e-4, 8.77e-5, 7.33e-5],
             [0.1498, 0.1456, 0.0317, 9.581e-4, 8.69e-5, 7.09e-5],
             [0.1496, 0.1456, 0.0317, 9.360e-4, 9.30e-5, 7.35e-5],
             [0.1497, 0.1457, 0.0317, 9.261e-4, 9.05e-5, 7.23e-5]]

effs_10mm = [[0.1625, 0.1520, 0.0330, 9.770e-4, 9.40e-5, 8.05e-5],
             [0.1625, 0.1521, 0.0332, 9.761e-4, 9.43e-5, 7.75e-5],
             [0.1626, 0.1520, 0.0332, 9.899e-4, 9.49e-5, 7.97e-5],
             [0.1626, 0.1521, 0.0331, 9.844e-4, 9.46e-5, 8.09e-5],
             [0.1625, 0.1522, 0.0332, 9.757e-4, 9.36e-5, 7.85e-5],
             [0.1627, 0.1522, 0.0332, 9.824e-4, 9.09e-5, 8.23e-5]]

effs_mean, d_effs = np.zeros(shape=(6,6)), np.zeros(shape=(6,6))

rads = ["gamma: \t\t", "Ka: \t\t", "Kb: \t\t", "511 keV: \t", "861 keV: \t", "1004 keV: \t"]
for i in range(6):
    for k in range(6):
        effs_mean[i][k] = (effs_12mm[i][k] + effs_10mm[i][k])/2
        d_effs[i][k] = effs_mean[i][k] - effs_10mm[i][k]
        print(f"{rads[k]}{effs_mean[i][k]:.3e} +- {d_effs[i][k]:.2e}")
    print()