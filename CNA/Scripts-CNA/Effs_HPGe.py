##################################################################
## Script to determine HPGe mean efficiencies and uncertainties ##
#################################################################

## ---------------- ##
import numpy as np
## ---------------- ##
          #  [158 kev, Ka   , Kb    , 511 keV , 861 keV, 1004 keV]
effs_18mm = [[0.1171, 0.1248, 0.0266, 8.196e-4, 7.87e-5, 5.06e-5],
             [0.1171, 0.1246, 0.0266, 8.142e-4, 7.45e-5, 5.51e-5],
             [0.1171, 0.1245, 0.0265, 8.372e-4, 7.87e-5, 5.16e-5],
             [0.1172, 0.1245, 0.0266, 8.125e-4, 7.20e-5, 6.09e-5],
             [0.1172, 0.1246, 0.0265, 8.256e-4, 7.44e-5, 5.66e-5],
             [0.1171, 0.1246, 0.0265, 8.184e-4, 8.01e-5, 5.75e-5]]

effs_16mm = [[0.1271, 0.1331, 0.0284, 8.721e-4, 8.24e-5, 6.33e-5],
             [0.1272, 0.1329, 0.0283, 8.430e-4, 8.15e-5, 5.96e-5],
             [0.1269, 0.1329, 0.0284, 8.484e-4, 7.86e-5, 5.98e-5],
             [0.1273, 0.1329, 0.0283, 8.705e-4, 8.05e-5, 5.81e-5],
             [0.1272, 0.1330, 0.0285, 8.758e-4, 8.21e-5, 6.07e-5],
             [0.1270, 0.1329, 0.0284, 8.502e-4, 8.06e-5, 6.65e-5]]

effs_mean, d_effs = np.zeros(shape=(6,6)), np.zeros(shape=(6,6))

rads = ["gamma: \t\t", "Ka: \t\t", "Kb: \t\t", "511 keV: \t", "861 keV: \t", "1004 keV: \t"]
for i in range(6):
    for k in range(6):
        effs_mean[i][k] = (effs_18mm[i][k] + effs_16mm[i][k])/2
        d_effs[i][k] = effs_mean[i][k] - effs_16mm[i][k]
        print(f"{rads[k]}{effs_mean[i][k]:.3e} +- {d_effs[i][k]:.2e}")
    print()